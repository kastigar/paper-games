<!DOCTYPE html>
<meta charset="utf-8">
<title>PaperRacing - PaperGames</title>

<script src="//vk.com/js/api/xd_connection.js?2"></script>
<script src="kinetic-v3.9.3.min.js"></script>
<script src="underscore.js"></script>
<script src="kinetic-ext.js"></script>
<script src="coffee-script.js"></script>

<script type="text/coffeescript" src="sheet.coffee"></script>
<script type="text/coffeescript" src="race-server.coffee"></script>
<script type="text/coffeescript" src="race-menu.coffee"></script>
<script type="text/coffeescript" src="single-race.coffee"></script>
<script type="text/coffeescript" src="race.coffee"></script>
<script type="text/coffeescript" src="track.coffee"></script>

<script type="text/coffeescript">
  VK.init ->
    window.URLParams = do ->
      p = []
      r = /([^&=]+)=?([^&]*)/g
      d = (s) -> decodeURIComponent(s.replace(/\+/g, " "))
      q = window.location.search.substring(1)

      p[d(m[1])] = d(m[2]) while m = r.exec(q)
      p

    paperSheet = new PaperSheet
      container: "container"

    new RaceServerActor
      player:
        name: URLParams.api_result.response[0].first_name
      onReady: (server) ->
        menu = new RaceMenu paperSheet, server
        menu.show()
</script>

<style>
  body {
    margin: 0;
  }
</style>

<div id="container"></div>